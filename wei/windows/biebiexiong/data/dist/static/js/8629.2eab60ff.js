/*!
 *  build: Vue  Admin Plus
 *  copyright: vue-admin-beautiful.com
 *  time: 2024-03-07 17:07:58
 */
"use strict";(self["webpackChunkadmin_plus"]=self["webpackChunkadmin_plus"]||[]).push([[8629],{96545:function(e,t,a){a.d(t,{Ix:function(){return l},bo:function(){return u},rp:function(){return r}});var n=a(96486),o=a(92325);function l(e){const t=(0,n.pickBy)(e,(e=>""!==e));return(0,o.Z)({url:"/wwwapi.php?to=suanli_market&modac=device_list",method:"get",params:t})}function u(e){return(0,o.Z)({url:"/wwwapi.php?to=suanli_market&modac=rent_form",method:"get",params:{client_id:e}})}function r(e){return(0,o.Z)({url:"/wwwapi.php?to=suanli_market&modac=rent_done",method:"post",data:e})}},45986:function(e,t,a){a.d(t,{AX:function(){return _},KG:function(){return u},X4:function(){return m},Xc:function(){return s},bh:function(){return i},m9:function(){return c},rK:function(){return r}});var n=a(96486),o=a(92325),l=a(11555);function u(e){const t=(0,n.pickBy)(e,(e=>""!==e));return(0,o.Z)({url:"/wwwapi.php?to=suanli_market_image&searchsort=1",method:"get",params:t})}async function r(e,t){return(0,l.Gv)().then((({body:{hash:a}})=>{const l={formhash:a,searchoption:{[t.inputId]:{value:t.keyword}},searchsortsubmit:""},u=(0,n.pickBy)(e,(e=>""!==e));return(0,o.Z)({url:"/wwwapi.php?to=suanli_market_image&searchsort=1",method:"post",params:u,data:l})}))}function i(e){return(0,o.Z)({url:"/wwwapi.php?to=postFavlist&thread_forum=suanli_image",method:"get",params:e})}function _(){return(0,o.Z)({url:"/wwwapi.php?to=suanli_market&modac=image_create_container_form",method:"get"})}function c(e){return(0,o.Z)({url:"/wwwapi.php?to=suanli_market&modac=image_create_download",method:"post",data:e})}async function m(e){const{body:{hash:t}}=await(0,l.Gv)();return(0,o.Z)({url:"/wwwapi.php?to=postFavAdd",method:"get",params:{id:e,formhash:t}})}async function s(e){const{body:{hash:t}}=await(0,l.Gv)();return(0,o.Z)({url:"/wwwapi.php?to=postFavDel",method:"post",data:{favid:e,formhash:t}})}},8629:function(e,t,a){a.r(t),a.d(t,{default:function(){return S}});var n=a(4350),o=(a(3241),a(91103),a(73481)),l=(a(62029),a(15659)),u=(a(10444),a(20129)),r=(a(69840),a(10661)),i=(a(35095),a(57018)),_=(a(74367),a(47820)),c=(a(50986),a(61715),a(6589),a(87692)),m=(a(45393),a(22411),a(57658),a(66252)),s=a(2262),d=a(3577),p=a(96545),f=a(45986);const w={ct_rent_type:[{required:!0,message:"租赁时长必选",trigger:"change"}],container_name:[{required:!0,message:"容器名称必填",trigger:"change"}]};var h=a(22201);const g={class:"comprehensive-form-container"},y={class:"w-full flex"};var v={__name:"createDialog",setup(e,{expose:t}){const a={...w,rent_gpu_count:[{validator(e,t,a){return U.value.rent_whole_or_container>0||t>=-1},message:"GPU数量必选",trigger:"change"}],persion_input_image_src:[{validator(e,t,a){return U.value.image_forum_id>0||""!=t},message:"私有镜像必填",trigger:"change"}]},v=()=>({client_id:"",rent_whole_or_container:"",rent_gpu_count:"",ct_rent_type:"",image_forum_id:"0",persion_input_image_src:"",container_ports:"",container_name:""}),U=(0,s.iH)({...v()}),k=(0,m.Fl)((()=>Z.value.host_gpu_left>=Z.value.host_gpu_count)),b=(0,m.Fl)((()=>Z.value.host_id?[{name:`${Z.value.host_hour_fee}元/小时/卡`,type:"hour"},{name:`${Z.value.host_daly_fee}元/日/卡`,type:"daly"},{name:`${Z.value.host_week_fee}元/周/卡`,type:"week"},{name:`${Z.value.host_month_fee}元/月/卡`,type:"month"}]:[])),S=(0,m.Fl)((()=>Z.value.host_id?[{name:`${Z.value.host_daly_fee_w}元/日`,type:"daly_w"},{name:`${Z.value.host_week_fee_w}元/周`,type:"week_w"},{name:`${Z.value.host_month_fee_w}元/月`,type:"month_w"}]:[])),V=(0,s.iH)(!1);function W(e){V.value=!0,j(e),$(),(0,m.Y3)((()=>{K.value.resetFields()}))}function H(){U.value.rent_whole_or_container=""===U.value.rent_gpu_count?1:0}const Z=(0,s.iH)({}),D=(0,s.iH)(!1);async function j(e){try{D.value=!0;const{body:t}=await(0,p.bo)(e);Z.value=t,U.value={...v(),client_id:e},H()}catch(t){}finally{D.value=!1}}const q=(0,s.iH)([]);async function $(){const{body:{list:e}}=await(0,f.bh)({page:1});q.value=e}function F(e){e&&(U.value.persion_input_image_src="")}const K=(0,s.iH)(),C=(0,m.f3)("$baseMessage"),G=(0,h.tv)(),Y=(0,s.iH)(!1);async function x(){await K.value.validate((async(e,t)=>{if(!e)return!1;const a={...U.value};0===a.image_forum_id&&(a.image_forum_id="");try{Y.value=!0;await(0,p.rp)(a);C("租赁成功","success","vab-hey-message-success"),G.push({path:"/gpumarket/myhosts"})}catch(n){}finally{Y.value=!1}}))}return t({showDialog:W}),(e,t)=>{const p=c.dn,f=c.KD,w=u.nH,h=_.BT,v=_.km,W=i.EZ,j=(0,m.up)("vab-icon"),$=r.Q0,C=u.ly,G=l.ElButton,B=o.d0,I=n.t;return(0,m.wg)(),(0,m.iD)("div",g,[(0,m.Wm)(B,{modelValue:(0,s.SU)(V),"onUpdate:modelValue":t[10]||(t[10]=e=>(0,s.dq)(V)?V.value=e:null),title:"创建容器",width:"800px"},{footer:(0,m.w5)((()=>[(0,m.Wm)(G,{onClick:t[9]||(t[9]=e=>V.value=!1)},{default:(0,m.w5)((()=>[(0,m.Uk)("取 消")])),_:1}),(0,m.Wm)(G,{type:"primary",loading:(0,s.SU)(Y),onClick:x},{default:(0,m.w5)((()=>[(0,m.Uk)(" 确 定 ")])),_:1},8,["loading"])])),default:(0,m.w5)((()=>[(0,m.wy)(((0,m.wg)(),(0,m.j4)(C,{ref_key:"formRef",ref:K,class:"demo-form",model:(0,s.SU)(U),rules:a,"label-width":"auto"},{default:(0,m.w5)((()=>[(0,m.Wm)(w,{label:"GPU数量",prop:"rent_gpu_count"},{default:(0,m.w5)((()=>[(0,m.Wm)(f,{modelValue:(0,s.SU)(U).rent_gpu_count,"onUpdate:modelValue":t[0]||(t[0]=e=>(0,s.SU)(U).rent_gpu_count=e),onChange:H},{default:(0,m.w5)((()=>[((0,m.wg)(!0),(0,m.iD)(m.HY,null,(0,m.Ko)((0,s.SU)(Z).host_gpu_left,(e=>((0,m.wg)(),(0,m.j4)(p,{key:e,label:e},null,8,["label"])))),128)),(0,s.SU)(k)?((0,m.wg)(),(0,m.j4)(p,{key:0,label:""},{default:(0,m.w5)((()=>[(0,m.Uk)("整租")])),_:1})):(0,m.kq)("",!0)])),_:1},8,["modelValue"])])),_:1}),(0,s.SU)(U).rent_whole_or_container>0?((0,m.wg)(),(0,m.j4)(w,{key:0,modelValue:(0,s.SU)(U).host_fee,"onUpdate:modelValue":t[2]||(t[2]=e=>(0,s.SU)(U).host_fee=e),label:"租赁时长",prop:"ct_rent_type"},{default:(0,m.w5)((()=>[(0,m.Wm)(f,{modelValue:(0,s.SU)(U).ct_rent_type,"onUpdate:modelValue":t[1]||(t[1]=e=>(0,s.SU)(U).ct_rent_type=e)},{default:(0,m.w5)((()=>[((0,m.wg)(!0),(0,m.iD)(m.HY,null,(0,m.Ko)((0,s.SU)(S),(e=>((0,m.wg)(),(0,m.j4)(p,{key:e.type,label:e.type},{default:(0,m.w5)((()=>[(0,m.Uk)((0,d.zw)(e.name),1)])),_:2},1032,["label"])))),128))])),_:1},8,["modelValue"])])),_:1},8,["modelValue"])):((0,m.wg)(),(0,m.j4)(w,{key:1,modelValue:(0,s.SU)(U).host_fee,"onUpdate:modelValue":t[4]||(t[4]=e=>(0,s.SU)(U).host_fee=e),label:"租赁时长",prop:"ct_rent_type"},{default:(0,m.w5)((()=>[(0,m.Wm)(f,{modelValue:(0,s.SU)(U).ct_rent_type,"onUpdate:modelValue":t[3]||(t[3]=e=>(0,s.SU)(U).ct_rent_type=e)},{default:(0,m.w5)((()=>[((0,m.wg)(!0),(0,m.iD)(m.HY,null,(0,m.Ko)((0,s.SU)(b),(e=>((0,m.wg)(),(0,m.j4)(p,{key:e.type,label:e.type},{default:(0,m.w5)((()=>[(0,m.Uk)((0,d.zw)(e.name),1)])),_:2},1032,["label"])))),128))])),_:1},8,["modelValue"])])),_:1},8,["modelValue"])),0==(0,s.SU)(U).rent_whole_or_container?((0,m.wg)(),(0,m.iD)(m.HY,{key:2},[(0,m.Wm)(w,{label:"选择镜像",prop:"persion_input_image_src"},{default:(0,m.w5)((()=>[(0,m._)("div",y,[(0,m.Wm)(v,{modelValue:(0,s.SU)(U).image_forum_id,"onUpdate:modelValue":t[5]||(t[5]=e=>(0,s.SU)(U).image_forum_id=e),filterable:"",placeholder:"选镜像",class:"container-name",onChange:F},{default:(0,m.w5)((()=>[(0,m.Wm)(h,{value:"0",label:"私有镜像"}),((0,m.wg)(!0),(0,m.iD)(m.HY,null,(0,m.Ko)((0,s.SU)(q),(e=>((0,m.wg)(),(0,m.j4)(h,{key:e.threadInfo.tid,label:e.title,value:e.threadInfo.tid},null,8,["label","value"])))),128))])),_:1},8,["modelValue"]),0==(0,s.SU)(U).image_forum_id?((0,m.wg)(),(0,m.j4)(W,{key:0,modelValue:(0,s.SU)(U).persion_input_image_src,"onUpdate:modelValue":t[6]||(t[6]=e=>(0,s.SU)(U).persion_input_image_src=e),placeholder:"请输入你要创建容器的私有镜像"},null,8,["modelValue"])):(0,m.kq)("",!0),(0,m.Wm)($,{effect:"dark",content:"先在镜像市场中找到对应镜像，然后添加收藏，之后才可以在这里看到",placement:"top",class:"mx-1"},{default:(0,m.w5)((()=>[(0,m.Wm)(j,{icon:"question-line",class:"cursor-pointer"})])),_:1})])])),_:1}),0==(0,s.SU)(U).image_forum_id?((0,m.wg)(),(0,m.j4)(w,{key:0,label:"映射端口"},{default:(0,m.w5)((()=>[(0,m.Wm)(W,{modelValue:(0,s.SU)(U).container_ports,"onUpdate:modelValue":t[7]||(t[7]=e=>(0,s.SU)(U).container_ports=e),placeholder:"如有需要穿透出来的端口，请按“22|8888|8790”这样格式提供"},null,8,["modelValue"])])),_:1})):(0,m.kq)("",!0),(0,m.Wm)(w,{label:"容器名称",prop:"container_name"},{default:(0,m.w5)((()=>[(0,m.Wm)(W,{modelValue:(0,s.SU)(U).container_name,"onUpdate:modelValue":t[8]||(t[8]=e=>(0,s.SU)(U).container_name=e),placeholder:"创建完成后好在“我的容器”中找它",class:"contianer-name"},null,8,["modelValue"])])),_:1})],64)):(0,m.kq)("",!0)])),_:1},8,["model"])),[[I,(0,s.SU)(D)]])])),_:1},8,["modelValue"])])}}};function U(e){e.__source="src/views/gpumarket/hosts/components/createDialog.vue"}var k=a(83744);"function"===typeof U&&U(v);const b=(0,k.Z)(v,[["__scopeId","data-v-24b34814"]]);var S=b}}]);