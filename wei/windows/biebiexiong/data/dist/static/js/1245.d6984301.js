/*!
 *  build: Vue  Admin Plus
 *  copyright: vue-admin-beautiful.com
 *  time: 2024-03-07 17:07:58
 */
"use strict";(self["webpackChunkadmin_plus"]=self["webpackChunkadmin_plus"]||[]).push([[1245],{30301:function(t,e,n){n.d(e,{$t:function(){return u},Cw:function(){return o},Q2:function(){return r},R:function(){return c},Ts:function(){return l},mX:function(){return i},ob:function(){return s}});var a=n(54258);function o(){return(0,a.Z)({url:"/run",method:"post",data:["wei-docker","download_check"]})}function i(){return(0,a.Z)({url:"/run/async",method:"post",data:["wei-docker","one_click"],timeout:0})}function s(){return(0,a.Z)({url:"/run",method:"post",data:["wei-docker","check"]})}function l(){return(0,a.Z)({url:"/run",method:"post",data:["wei-docker","is_installed"]})}function r(){return(0,a.Z)({url:"/run",method:"post",data:["wei-docker","uninstall"]})}function c(){return(0,a.Z)({url:"/run",method:"post",data:["wei-docker","docker_service_auto_start"]})}function u(){return(0,a.Z)({url:"/run",method:"post",data:["wei-docker","docker_service_auto_stop"]})}},95965:function(t,e,n){n.d(e,{Z:function(){return i}});var a=n(23279),o=n.n(a);function i(){function t(t,e=3e3){return setInterval((()=>{t()}),e)}function e(t){t&&clearInterval(t)}function n(t,e=1e4){return setTimeout((()=>{t()}),e)}function a(t,e=3e3){o()((()=>{t()}),e)()}return{startIntervalTimer:t,stopIntervalTimer:e,startTimeoutTimer:n,startDebounce:a}}},21245:function(t,e,n){n.r(e),n.d(e,{default:function(){return I}});var a=n(27750),o=n(91557),i=(n(3241),n(35635),n(32018)),s=(n(46160),n(66252)),l=n(2262),r=n(65671),c=n(65847),u=n(30301),d=n(54748);function f(t){return(0,d.Z)(parseFloat(t))}var w=n(95965);const p=t=>((0,s.dD)("data-v-9db465a2"),t=t(),(0,s.Cn)(),t),m={key:0},v=p((()=>(0,s._)("p",null,"初始化设备",-1)));var _={__name:"device_action_local_init",setup(t){const{startIntervalTimer:e,stopIntervalTimer:n}=(0,w.Z)(),d=(0,s.f3)("$pub"),p=(0,s.f3)("$sub"),_=(0,s.f3)("$unsub"),g=(0,s.f3)("deviceInfo"),y=(0,l.qj)({isDownloadIng:!1,isInstallIng:!1,isInstalled:!1,status:{},downloadPercent:0,downloadSpeed:"0 B",timer:0});async function h(){const{is_installed:t}=await(0,u.Ts)();y.isInstalled=t}(0,s.bv)((()=>{h(),b()})),(0,s.Ah)((()=>{_("watch-download-progress"),_("watch-install-progress"),n(y.timer)})),(0,s.JJ)("deviceData",y);const I=(0,l.iH)();function k(){I.value.showDialog()}async function b(){if(localStorage.getItem("cancel-init-device"))return y.isDownloadIng=!1,!1;const{data:t}=await(0,u.Cw)();if(t){const{completed_length:e,total_length:n}=t;e!==n?(y.isDownloadIng=!0,d("watch-download-progress")):y.isDownloadIng=!1}else y.isDownloadIng=!1}async function S(){const{data:t}=await(0,u.Cw)(),{download_speed:e,completed_length:n,total_length:a}=t;if(n>0&&a>0){const t=Math.round(n/a*100);y.downloadPercent=t}else y.downloadPercent=0;y.downloadSpeed=f(e)||"",parseInt(n)>=parseInt(a)?(y.isDownloadIng=!1,y.isInstallIng=!0,d("watch-install-progress")):y.isDownloadIng=!0}function W(){g.value.host_service_up_default?(0,u.R)():(0,u.$t)()}return p("watch-download-progress",(()=>{n(y.timer),y.timer=e((()=>{S()}))})),p("watch-install-progress",(()=>{n(y.timer),y.timer=e((async()=>{const{progress:t}=await(0,u.ob)();if(y.status=t,y.status.ubuntu&&!y.isInstalled){const{is_installed:t}=await(0,u.Ts)();y.isInstalled=t,t&&(n(y.timer),y.isInstallIng=!1,W())}}))})),(t,e)=>{const n=i.Xh,u=(0,s.up)("vab-icon"),d=o.dQ,f=a.Z;return(0,l.SU)(y).isInstalled?((0,s.wg)(),(0,s.j4)((0,l.SU)(r["default"]),{key:1})):((0,s.wg)(),(0,s.iD)("div",m,[(0,s.Wm)(f,{shadow:"hover",class:"icon-panel",onClick:e[0]||(e[0]=t=>k())},{default:(0,s.w5)((()=>[(0,l.SU)(y).isDownloadIng||(0,l.SU)(y).isInstallIng?((0,s.wg)(),(0,s.j4)(n,{key:0,"text-inside":!0,"stroke-width":26,percentage:(0,l.SU)(y).downloadPercent,style:{height:"50px"}},null,8,["percentage"])):((0,s.wg)(),(0,s.j4)(d,{key:1},{default:(0,s.w5)((()=>[(0,s.Wm)(u,{icon:"intall-pc","is-custom-svg":"",style:{color:"green"}})])),_:1})),v])),_:1}),(0,s.Wm)(c["default"],{ref_key:"initDialogRef",ref:I},null,512)]))}}};function g(t){t.__source="src/views/gpumarket/mydevice/components/device_action_local_init.vue"}var y=n(83744);"function"===typeof g&&g(_);const h=(0,y.Z)(_,[["__scopeId","data-v-9db465a2"]]);var I=h},65671:function(t,e,n){n.r(e),n.d(e,{default:function(){return m}});var a=n(50591),o=(n(3241),n(89035),n(27750)),i=n(91557),s=(n(35635),n(57658),n(66252)),l=n(23471),r=n(22201);const c=t=>((0,s.dD)("data-v-0684e017"),t=t(),(0,s.Cn)(),t),u=c((()=>(0,s._)("p",null,"卸载重置",-1)));var d={__name:"device_action_reset",setup(t){const e=(0,r.yj)(),n=(0,r.tv)();async function c(){await(0,l.c1)(e.params.id);n.push("/gpumarket/mydevice")}return(t,e)=>{const n=(0,s.up)("vab-icon"),l=i.dQ,r=o.Z,d=a.i1;return(0,s.wg)(),(0,s.j4)(d,{title:"卸载将丢失当前的所有容器和镜像，您确定要卸载吗？",onConfirm:c},{reference:(0,s.w5)((()=>[(0,s.Wm)(r,{class:"icon-panel",shadow:"hover"},{default:(0,s.w5)((()=>[(0,s.Wm)(l,null,{default:(0,s.w5)((()=>[(0,s.Wm)(n,{icon:"intall-pc","is-custom-svg":"",style:{color:"green"}})])),_:1}),u])),_:1})])),_:1})}}};function f(t){t.__source="src/views/gpumarket/mydevice/components/device_action_reset.vue"}var w=n(83744);"function"===typeof f&&f(d);const p=(0,w.Z)(d,[["__scopeId","data-v-0684e017"]]);var m=p},65847:function(t,e,n){n.r(e),n.d(e,{default:function(){return Z}});var a=n(73481),o=(n(3241),n(62029),n(73632)),i=(n(74965),n(66263)),s=(n(33790),n(50591)),l=(n(89035),n(15659)),r=(n(10444),n(22040)),c=(n(99426),n(32018)),u=(n(46160),n(27682)),d=(n(98661),n(83495),n(66252)),f=n(2262),w=n(30301),p=n(95965);const m=t=>((0,d.dD)("data-v-94527f52"),t=t(),(0,d.Cn)(),t),v={class:"step-form-container"},_={key:0,class:"mt-2 mb-2"},g={class:"flex w-full justify-center mb-4"},y={key:0},h={key:1},I=m((()=>(0,d._)("p",null," 1/系统在第一次初始化的时候，会自动重启一次，请在执行初始化前先保存好电脑上的资料。 ",-1))),k=m((()=>(0,d._)("p",null," 2/系统重启后会自动的再次进入初始化设备操作，如果没有自动运行，请手动再点一次“初始化设备”，选择继续。 ",-1))),b=m((()=>(0,d._)("p",null," 3/后端服务Docker需要开启以后才可以设置设备出租和挂机。如果您手工开启关闭麻烦，请选择开机默认开启后端服务。 ",-1)));var S={__name:"init_dialog",setup(t,{expose:e}){const{startIntervalTimer:n,stopIntervalTimer:m}=(0,p.Z)(),S=(0,d.f3)("$pub"),W=((0,d.f3)("$sub"),(0,d.f3)("$unsub")),D=(0,d.f3)("deviceData"),U=(0,d.Fl)((()=>!(!D.isDownloadIng&&!D.isInstallIng))),Z=(0,f.iH)(!1);(0,d.Ah)((()=>{W("watch-install-progress")}));const C=(0,d.Fl)((()=>{if(D.isDownloadIng)return 0;if(!D.status.file_check)return 0;const t={hyper:1,wsl:2,wsl2:3,wsl_update:4,ubuntu:5};let e=0;for(const n in t)if(D.status[n]){const a=t[n]+1;e=a>e?a:e}return D.isInstalled&&(e=6),e}));function $(){Z.value=!0,L()}function j(t){return 100===t?"下载完毕":`正在下载文件 ${D.downloadSpeed??"0 B"}/s ${t}%`}async function T(){localStorage.removeItem("cancel-init-device"),D.isDownloadIng||((0,w.mX)(),D.isDownloadIng=!0,S("watch-download-progress"))}function x(){Z.value=!1,D.isDownloadIng=!1,localStorage.setItem("cancel-init-device",!0),m(D.timer)}async function L(){const{progress:t}=await(0,w.ob)();D.status=t,localStorage.getItem("cancel-init-device")&&(D.status.file_check=!1)}const F=(0,f.iH)(!1);async function H(){try{F.value=!0,await(0,w.Q2)(),D.isInstalled=!1;const{progress:t}=await(0,w.ob)();D.status=t}catch(t){}finally{F.value=!1}}return e({showDialog:$}),(t,e)=>{const n=u.Gg,w=u.C4,p=c.Xh,m=r.Dv,S=l.ElButton,W=s.i1,$=i.v,L=o.dq,F=a.d0;return(0,d.wg)(),(0,d.j4)(F,{modelValue:(0,f.SU)(Z),"onUpdate:modelValue":e[0]||(e[0]=t=>(0,f.dq)(Z)?Z.value=t:null),title:"初始化设备",width:"50%","close-on-click-modal":!1,"close-on-press-escape":!1},{default:(0,d.w5)((()=>[(0,d._)("div",v,[(0,d.Wm)(L,{gutter:20},{default:(0,d.w5)((()=>[(0,d.Wm)(m,null,{default:(0,d.w5)((()=>[(0,d.Wm)(w,{active:(0,f.SU)(C),"align-center":"",class:"steps"},{default:(0,d.w5)((()=>[(0,d.Wm)(n,{description:"软件检测",title:"File_check"}),(0,d.Wm)(n,{description:"设置hyper",title:"Hyper setting"}),(0,d.Wm)(n,{description:"安装WSL",title:"WSL Install"}),(0,d.Wm)(n,{description:"设置WSL",title:"WSL setting"}),(0,d.Wm)(n,{description:"更新系统",title:"WSL update"}),(0,d.Wm)(n,{description:"安装Linux",title:"Install Linux"}),(0,d.Wm)(n,{description:"完成",title:"Finish"})])),_:1},8,["active"]),(0,f.SU)(D).isDownloadIng?((0,d.wg)(),(0,d.iD)("div",_,[(0,d.Wm)(p,{"text-inside":!0,"stroke-width":26,percentage:(0,f.SU)(D).downloadPercent,format:j},null,8,["percentage"])])):(0,d.kq)("",!0)])),_:1}),(0,d.Wm)(m,null,{default:(0,d.w5)((()=>[(0,d._)("div",g,[(0,f.SU)(D).isInstalled?((0,d.wg)(),(0,d.iD)("div",h,[(0,d.Wm)(S,{loading:(0,f.SU)(D).uninstallLoading,type:"primary",onClick:H},{default:(0,d.w5)((()=>[(0,d.Uk)(" 卸载 ")])),_:1},8,["loading"])])):((0,d.wg)(),(0,d.iD)("div",y,[(0,d._)("div",null,[(0,f.SU)(D).status.first_reboot?((0,d.wg)(),(0,d.j4)(S,{key:0,loading:(0,f.SU)(U),type:"primary",onClick:T},{default:(0,d.w5)((()=>[(0,d.Uk)(" 开始初始化 ")])),_:1},8,["loading"])):((0,d.wg)(),(0,d.j4)(W,{key:1,title:"安装过程会重启设备，确定安装吗？",onConfirm:T},{reference:(0,d.w5)((()=>[(0,d.Wm)(S,{loading:(0,f.SU)(U),type:"primary"},{default:(0,d.w5)((()=>[(0,d.Uk)(" 开始初始化 ")])),_:1},8,["loading"])])),_:1})),(0,d.Wm)(S,{onClick:x},{default:(0,d.w5)((()=>[(0,d.Uk)("关闭")])),_:1})])]))])])),_:1}),(0,d.Wm)(m,null,{default:(0,d.w5)((()=>[(0,d.Wm)($,{closable:!1},{default:(0,d.w5)((()=>[I,k,b])),_:1})])),_:1})])),_:1})])])),_:1},8,["modelValue"])}}};function W(t){t.__source="src/views/gpumarket/mydevice/components/init_dialog.vue"}var D=n(83744);"function"===typeof W&&W(S);const U=(0,D.Z)(S,[["__scopeId","data-v-94527f52"]]);var Z=U},27750:function(t,e,n){n.d(e,{Z:function(){return w}});var a=n(30032),o=(n(3241),n(91154),n(97830)),i=(n(13768),n(66252)),s=n(2262),l=n(3577),r=n(22201),c=(0,i.aZ)({__name:"index",props:{header:{type:String,default:""},bodyStyle:{type:Object,default:()=>({})},shadow:{type:String,default:""},skeleton:{type:Boolean,default:!1},skeletonRows:{type:Number,default:4}},setup(t){let e=null;const n=(0,s.iH)(!0);return e=setTimeout((()=>{n.value=!1}),500),(0,r.iS)(((t,n,a)=>{clearInterval(e),a()})),(e,r)=>{const c=o.vk,u=a.Kf;return(0,i.wg)(),(0,i.j4)(u,{"body-style":t.bodyStyle,class:"vab-card",shadow:t.shadow},(0,i.Nv)({default:(0,i.w5)((()=>[t.skeleton?((0,i.wg)(),(0,i.j4)(c,{key:0,animated:"",loading:(0,s.SU)(n),rows:t.skeletonRows},{default:(0,i.w5)((()=>[(0,i.WI)(e.$slots,"default",{class:"vab-card-transition"})])),_:3},8,["loading","rows"])):(0,i.WI)(e.$slots,"default",{key:1,class:"vab-card-transition"})])),_:2},[e.$slots.header||t.header?{name:"header",fn:(0,i.w5)((()=>[(0,i.WI)(e.$slots,"header",{},(()=>[(0,i.Uk)((0,l.zw)(t.header),1)]))])),key:"0"}:void 0]),1032,["body-style","shadow"])}}});function u(t){t.__source="library/components/VabCard/index.vue"}var d=n(83744);"function"===typeof u&&u(c);const f=(0,d.Z)(c,[["__scopeId","data-v-391150ea"]]);var w=f}}]);