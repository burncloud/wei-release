/*!
 *  build: Vue  Admin Plus
 *  copyright: vue-admin-beautiful.com
 *  time: 2024-03-07 17:07:58
 */
"use strict";(self["webpackChunkadmin_plus"]=self["webpackChunkadmin_plus"]||[]).push([[5847],{30301:function(t,e,n){n.d(e,{$t:function(){return c},Cw:function(){return o},Q2:function(){return u},R:function(){return s},Ts:function(){return a},mX:function(){return r},ob:function(){return l}});var i=n(54258);function o(){return(0,i.Z)({url:"/run",method:"post",data:["wei-docker","download_check"]})}function r(){return(0,i.Z)({url:"/run/async",method:"post",data:["wei-docker","one_click"],timeout:0})}function l(){return(0,i.Z)({url:"/run",method:"post",data:["wei-docker","check"]})}function a(){return(0,i.Z)({url:"/run",method:"post",data:["wei-docker","is_installed"]})}function u(){return(0,i.Z)({url:"/run",method:"post",data:["wei-docker","uninstall"]})}function s(){return(0,i.Z)({url:"/run",method:"post",data:["wei-docker","docker_service_auto_start"]})}function c(){return(0,i.Z)({url:"/run",method:"post",data:["wei-docker","docker_service_auto_stop"]})}},95965:function(t,e,n){n.d(e,{Z:function(){return r}});var i=n(23279),o=n.n(i);function r(){function t(t,e=3e3){return setInterval((()=>{t()}),e)}function e(t){t&&clearInterval(t)}function n(t,e=1e4){return setTimeout((()=>{t()}),e)}function i(t,e=3e3){o()((()=>{t()}),e)()}return{startIntervalTimer:t,stopIntervalTimer:e,startTimeoutTimer:n,startDebounce:i}}},65847:function(t,e,n){n.r(e),n.d(e,{default:function(){return Z}});var i=n(73481),o=(n(3241),n(62029),n(73632)),r=(n(74965),n(66263)),l=(n(33790),n(50591)),a=(n(89035),n(15659)),u=(n(10444),n(22040)),s=(n(99426),n(32018)),c=(n(46160),n(27682)),d=(n(98661),n(83495),n(66252)),f=n(2262),m=n(30301),p=n(95965);const w=t=>((0,d.dD)("data-v-94527f52"),t=t(),(0,d.Cn)(),t),_={class:"step-form-container"},g={key:0,class:"mt-2 mb-2"},v={class:"flex w-full justify-center mb-4"},k={key:0},h={key:1},y=w((()=>(0,d._)("p",null," 1/系统在第一次初始化的时候，会自动重启一次，请在执行初始化前先保存好电脑上的资料。 ",-1))),I=w((()=>(0,d._)("p",null," 2/系统重启后会自动的再次进入初始化设备操作，如果没有自动运行，请手动再点一次“初始化设备”，选择继续。 ",-1))),W=w((()=>(0,d._)("p",null," 3/后端服务Docker需要开启以后才可以设置设备出租和挂机。如果您手工开启关闭麻烦，请选择开机默认开启后端服务。 ",-1)));var S={__name:"init_dialog",setup(t,{expose:e}){const{startIntervalTimer:n,stopIntervalTimer:w}=(0,p.Z)(),S=(0,d.f3)("$pub"),D=((0,d.f3)("$sub"),(0,d.f3)("$unsub")),b=(0,d.f3)("deviceData"),U=(0,d.Fl)((()=>!(!b.isDownloadIng&&!b.isInstallIng))),Z=(0,f.iH)(!1);(0,d.Ah)((()=>{D("watch-install-progress")}));const C=(0,d.Fl)((()=>{if(b.isDownloadIng)return 0;if(!b.status.file_check)return 0;const t={hyper:1,wsl:2,wsl2:3,wsl_update:4,ubuntu:5};let e=0;for(const n in t)if(b.status[n]){const i=t[n]+1;e=i>e?i:e}return b.isInstalled&&(e=6),e}));function L(){Z.value=!0,j()}function T(t){return 100===t?"下载完毕":`正在下载文件 ${b.downloadSpeed??"0 B"}/s ${t}%`}async function $(){localStorage.removeItem("cancel-init-device"),b.isDownloadIng||((0,m.mX)(),b.isDownloadIng=!0,S("watch-download-progress"))}function x(){Z.value=!1,b.isDownloadIng=!1,localStorage.setItem("cancel-init-device",!0),w(b.timer)}async function j(){const{progress:t}=await(0,m.ob)();b.status=t,localStorage.getItem("cancel-init-device")&&(b.status.file_check=!1)}const F=(0,f.iH)(!1);async function q(){try{F.value=!0,await(0,m.Q2)(),b.isInstalled=!1;const{progress:t}=await(0,m.ob)();b.status=t}catch(t){}finally{F.value=!1}}return e({showDialog:L}),(t,e)=>{const n=c.Gg,m=c.C4,p=s.Xh,w=u.Dv,S=a.ElButton,D=l.i1,L=r.v,j=o.dq,F=i.d0;return(0,d.wg)(),(0,d.j4)(F,{modelValue:(0,f.SU)(Z),"onUpdate:modelValue":e[0]||(e[0]=t=>(0,f.dq)(Z)?Z.value=t:null),title:"初始化设备",width:"50%","close-on-click-modal":!1,"close-on-press-escape":!1},{default:(0,d.w5)((()=>[(0,d._)("div",_,[(0,d.Wm)(j,{gutter:20},{default:(0,d.w5)((()=>[(0,d.Wm)(w,null,{default:(0,d.w5)((()=>[(0,d.Wm)(m,{active:(0,f.SU)(C),"align-center":"",class:"steps"},{default:(0,d.w5)((()=>[(0,d.Wm)(n,{description:"软件检测",title:"File_check"}),(0,d.Wm)(n,{description:"设置hyper",title:"Hyper setting"}),(0,d.Wm)(n,{description:"安装WSL",title:"WSL Install"}),(0,d.Wm)(n,{description:"设置WSL",title:"WSL setting"}),(0,d.Wm)(n,{description:"更新系统",title:"WSL update"}),(0,d.Wm)(n,{description:"安装Linux",title:"Install Linux"}),(0,d.Wm)(n,{description:"完成",title:"Finish"})])),_:1},8,["active"]),(0,f.SU)(b).isDownloadIng?((0,d.wg)(),(0,d.iD)("div",g,[(0,d.Wm)(p,{"text-inside":!0,"stroke-width":26,percentage:(0,f.SU)(b).downloadPercent,format:T},null,8,["percentage"])])):(0,d.kq)("",!0)])),_:1}),(0,d.Wm)(w,null,{default:(0,d.w5)((()=>[(0,d._)("div",v,[(0,f.SU)(b).isInstalled?((0,d.wg)(),(0,d.iD)("div",h,[(0,d.Wm)(S,{loading:(0,f.SU)(b).uninstallLoading,type:"primary",onClick:q},{default:(0,d.w5)((()=>[(0,d.Uk)(" 卸载 ")])),_:1},8,["loading"])])):((0,d.wg)(),(0,d.iD)("div",k,[(0,d._)("div",null,[(0,f.SU)(b).status.first_reboot?((0,d.wg)(),(0,d.j4)(S,{key:0,loading:(0,f.SU)(U),type:"primary",onClick:$},{default:(0,d.w5)((()=>[(0,d.Uk)(" 开始初始化 ")])),_:1},8,["loading"])):((0,d.wg)(),(0,d.j4)(D,{key:1,title:"安装过程会重启设备，确定安装吗？",onConfirm:$},{reference:(0,d.w5)((()=>[(0,d.Wm)(S,{loading:(0,f.SU)(U),type:"primary"},{default:(0,d.w5)((()=>[(0,d.Uk)(" 开始初始化 ")])),_:1},8,["loading"])])),_:1})),(0,d.Wm)(S,{onClick:x},{default:(0,d.w5)((()=>[(0,d.Uk)("关闭")])),_:1})])]))])])),_:1}),(0,d.Wm)(w,null,{default:(0,d.w5)((()=>[(0,d.Wm)(L,{closable:!1},{default:(0,d.w5)((()=>[y,I,W])),_:1})])),_:1})])),_:1})])])),_:1},8,["modelValue"])}}};function D(t){t.__source="src/views/gpumarket/mydevice/components/init_dialog.vue"}var b=n(83744);"function"===typeof D&&D(S);const U=(0,b.Z)(S,[["__scopeId","data-v-94527f52"]]);var Z=U}}]);