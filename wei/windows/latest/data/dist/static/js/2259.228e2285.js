/*!
 *  build: Vue  Admin Plus
 *  copyright: vue-admin-beautiful.com
 *  time: 2024-01-23 10:23:14
 */
"use strict";(self["webpackChunkadmin_plus"]=self["webpackChunkadmin_plus"]||[]).push([[2259],{81464:function(e,t,a){a.d(t,{Z:function(){return l}});var o=a(81095),n=a(26593);function i(e){o.gp.$baseMessage(`拷贝${e}成功`,"success","vab-hey-message-success",!1)}function s(e){o.gp.$baseMessage(`拷贝${e}失败`,"error","vab-hey-message-success",!1)}function l(e){const{isSupported:t,copy:a}=(0,n.VPI)();t||(0,n.gIw)("clipboard-write"),a(e).then((()=>{i(e)})).catch((t=>{console.log(t),s(e)}))}},27324:function(e,t,a){a.d(t,{Z:function(){return m}});a(57658);var o=a(81095),n=a(53580),i=a(15790),s=a(26010),l=a(81464),r=a(22201),c=a(66252),u=a(2262);const d=(0,i.L)();function m(){const e=(0,r.yj)();(0,c.bv)((()=>{b()}));const t={tid:e.params.id,page:1},a={pageSize:1,total:1},i=(0,u.qj)({detail:{},images:[],comments:[],extraInfo:{},favId:0,likeId:0}),m=(0,u.iH)({});function f(e){return e?Object.values(e).map((e=>({id:e.aid,image:`${e.url}${e.attachment}`,height:e.height}))):[]}const p=(0,c.Fl)((()=>f(i.detail.attachments))),g=(0,c.Fl)((()=>i.detail.tid)),v=(0,c.Fl)((()=>i.detail.pid)),_=(0,c.Fl)((()=>i.detail.fid)),w=(0,c.Fl)((()=>d.canAction(i.detail.authorid))),y=(0,c.Fl)((()=>i.detail.tags?i.detail.tags.map((e=>({id:e[0],name:e[1]}))):[])),h=(0,c.Fl)((()=>(0,s.Gc)(t.page,a.pageSize,a.total-1)));async function b(){const{body:{list:e,threadsortshow:o,forum_thread:s,page_perpage:l,page_allcount:r}}=await(0,n.BN)(t),c=e;i.detail=c[0]??{},i.comments=c.slice(1),i.extraInfo=s,i.favId=i.detail.threadHasFavorite?.favid??0,i.likeId=i.detail.threadHasRecommend?.tid??0,a.pageSize=parseInt(l),a.total=parseInt(r),F(i.detail.attachments);const u=Object.fromEntries(Object.entries(o.optionlist).map((e=>(e[0]=e[0].replace(/^(image|model)_/,""),e))));m.value=u}async function x(){const{body:{list:e,forum_thread:o,page_perpage:s,page_allcount:l}}=await(0,n.BN)(t);i.comments=[e[1],...i.comments],i.extraInfo=o,a.pageSize=parseInt(s),a.total=parseInt(l)}async function S(){if(h.value)return;t.page++;const{body:{list:e,page_perpage:o,page_allcount:s}}=await(0,n.BN)(t);i.comments.push(...e),a.pageSize=parseInt(o),a.total=parseInt(s)}async function k(){await(0,n.Xq)(i.favId),i.favId=0,i.extraInfo.favtimes--,o.gp.$baseMessage("取消收藏成功","success","vab-hey-message-success")}async function U(){const{body:{favid:e}}=await(0,n.l0)(t.tid);e>0?(i.favId=e,i.extraInfo.favtimes++,o.gp.$baseMessage("收藏成功","success","vab-hey-message-success")):o.gp.$baseMessage("收藏失败","error","vab-hey-message-error")}const I=(0,u.qj)({imageIndex:0,imageId:0,imageDetail:{},imageLog:{}});function F(e){const t=f(e);I.imageIndex=0,I.imageId=t[0]?t[0].id:0}function W(e){(0,s.Oo)()&&(e.preventDefault(),"A"===e.target.nodeName.toLocaleUpperCase()&&(0,l.Z)(e.target.href))}return{topicInfo:i,imageTimeline:m,images:p,getTid:g,getPid:v,getFid:_,canAction:w,getTopicTags:y,hasNoMoreData:h,loadTopic:b,loadAddedTopic:x,loadMoreComments:S,handleDelFavTopic:k,handleAddFavTopic:U,interceptLinkHref:W,imageInfo:I}}},63877:function(e,t,a){a.d(t,{Nb:function(){return i},jQ:function(){return o},jl:function(){return n}});const o={message:[{required:!0,message:"评论内容必填",trigger:"blur"}]},n={report_select:[{required:!0,message:"请选择举报类型",trigger:"blur"}],message:[{required:!0,message:"举报内容必填",trigger:"blur"},{min:8,max:255,message:"举报内容长度必须在8-255个字符",trigger:"blur"}]},i={images:[{required:!0,message:"发帖需要至少一张图片",trigger:"blur"}],subject:[{required:!0,message:"内容必填",trigger:"blur"}],tags:[{required:!0,message:"至少选择一个标签",trigger:"blur"}]}},49527:function(e,t,a){a.r(t),a.d(t,{default:function(){return d}});var o=a(66252),n=a(3577),i=a(2262);const s={class:"box"};var l={__name:"index",props:{icon:{type:String,default:""},size:{type:String,default:""},text:{type:[Number,String],default:""},color:{type:String,default:""}},setup(e){const t=e,a=(0,o.Fl)((()=>{const e={fontSize:t.size};return t.color&&(e.color=t.color),e}));return(t,l)=>{const r=(0,o.up)("vab-icon");return(0,o.wg)(),(0,o.iD)("div",s,[(0,o.Wm)(r,{icon:e.icon,style:(0,n.j5)((0,i.SU)(a)),class:"icon"},null,8,["icon","style"]),(0,o._)("span",{style:(0,n.j5)((0,i.SU)(a))},(0,n.zw)(e.text),5)])}}};function r(e){e.__source="src/components/IconText/index.vue"}var c=a(83744);"function"===typeof r&&r(l);const u=(0,c.Z)(l,[["__scopeId","data-v-55dcc2f6"]]);var d=u},57506:function(e,t,a){a.r(t),a.d(t,{default:function(){return v}});var o=a(20129),n=(a(3241),a(69840),a(15659)),i=(a(10444),a(6589),a(57018)),s=(a(74367),a(66252)),l=a(2262),r=a(49963),c=a(63877),u=a(53580);const d={class:"form"};var m={__name:"form",props:{tid:{type:String,default:"0"}},emits:["reload"],setup(e,{expose:t,emit:a}){const m=e,f=(0,s.f3)("$baseMessage"),p=(0,l.qj)({showTextarea:!1,rules:{...c.jQ},topicFormRef:null,inputCommentRef:null,loading:!1}),g=(0,l.qj)({tid:m.tid,pid:0,message:""});(0,s.YP)((()=>m.tid),(()=>{g.tid=m.tid}));const{topicFormRef:v,inputCommentRef:_}=(0,l.BK)(p);function w(){p.showTextarea=!0,y()}function y(){p["topicFormRef"].clearValidate(),(0,s.Y3)((()=>{_.value.focus()}))}async function h(){try{p.loading=!0;const e=/@\w+ /g;e.test(g.message)?await(0,u.kA)(g):await(0,u.NY)(g),g.message="",a("reload"),f("回复成功","success","vab-hey-message-success")}catch(e){console.log(e)}finally{p.loading=!1}}async function b(){p["topicFormRef"].validate((e=>{e&&h()}))}function x(e,t){p.showTextarea=!0,g.pid=e,g.message+=`@${t} `,y()}return t({bindReplyAuthor:x}),(e,t)=>{const a=i.EZ,c=o.nH,u=n.ElButton,m=o.ly;return(0,s.wg)(),(0,s.iD)("div",d,[(0,s.Wm)(m,{ref_key:"topicFormRef",ref:v,model:(0,l.SU)(g),rules:(0,l.SU)(p).rules},{default:(0,s.w5)((()=>[(0,s.wy)((0,s._)("div",null,[(0,s.Wm)(c,{prop:"message"},{default:(0,s.w5)((()=>[(0,s.Wm)(a,{ref_key:"inputCommentRef",ref:_,modelValue:(0,l.SU)(g).message,"onUpdate:modelValue":t[0]||(t[0]=e=>(0,l.SU)(g).message=e),placeholder:"在这里输入评论内容",type:"textarea",maxlength:"256",rows:3,"show-word-limit":""},null,8,["modelValue"])])),_:1}),(0,s.Wm)(u,{type:"primary",class:"button",disabled:""===(0,l.SU)(g).message,loading:(0,l.SU)(p).loading,onClick:b},{default:(0,s.w5)((()=>[(0,s.Uk)(" 评论 ")])),_:1},8,["disabled","loading"])],512),[[r.F8,(0,l.SU)(p).showTextarea]]),(0,s.wy)((0,s._)("div",null,[(0,s.Wm)(a,{placeholder:"在这里输入评论内容",onFocus:w})],512),[[r.F8,!(0,l.SU)(p).showTextarea]])])),_:1},8,["model","rules"])])}}};function f(e){e.__source="src/components/Topic/form.vue"}var p=a(83744);"function"===typeof f&&f(m);const g=(0,p.Z)(m,[["__scopeId","data-v-75d0045b"]]);var v=g},91131:function(e,t,a){a.r(t),a.d(t,{default:function(){return m}});var o=a(10661),n=(a(3241),a(35095),a(66252)),i=a(2262),s=a(49527);const l={class:"info-box"};var r={__name:"image_actions",props:{topic:{type:Object,default:()=>{}},imageTimeline:{type:Object,default:()=>{}},canAction:{type:Boolean,default:!1}},emits:["delFav","addFav"],setup(e,{emit:t}){const a=e,{extraInfo:r,favId:c}=(0,i.BK)(a.topic);function u(){t("delFav")}function d(){t("addFav")}return(t,a)=>{const m=o.Q0;return(0,n.wg)(),(0,n.iD)("div",l,[(0,n.Wm)(m,{class:"box-item",effect:"dark",content:"收藏",placement:"top"},{default:(0,n.w5)((()=>[(0,n._)("div",null,[(0,i.SU)(c)>0?((0,n.wg)(),(0,n.j4)((0,i.SU)(s["default"]),{key:0,icon:"star-fill",text:(0,i.SU)(r).favtimes,color:"#B43838",class:"icon cursor-pointer",onClick:u},null,8,["text"])):((0,n.wg)(),(0,n.j4)((0,i.SU)(s["default"]),{key:1,icon:"star-line",text:(0,i.SU)(r).favtimes,color:"#B43838",class:"icon cursor-pointer",onClick:d},null,8,["text"]))])])),_:1}),e.imageTimeline.download?((0,n.wg)(),(0,n.iD)(n.HY,{key:0},[(0,n.Wm)(m,{class:"box-item",effect:"dark",content:e.imageTimeline.download.title,placement:"top"},{default:(0,n.w5)((()=>[(0,n.Wm)((0,i.SU)(s["default"]),{icon:"download-2-line",text:e.imageTimeline.download.value,class:"icon"},null,8,["text"])])),_:1},8,["content"]),(0,n.Wm)(m,{class:"box-item",effect:"dark",content:"评论",placement:"top"},{default:(0,n.w5)((()=>[(0,n.Wm)((0,i.SU)(s["default"]),{icon:"chat-poll-line",text:(0,i.SU)(r).replies,class:"icon"},null,8,["text"])])),_:1}),(0,n.Wm)(m,{class:"box-item",effect:"dark",content:e.imageTimeline.size.title,placement:"top"},{default:(0,n.w5)((()=>[(0,n.Wm)((0,i.SU)(s["default"]),{icon:"database-2-line",text:e.imageTimeline.size.value,class:"icon"},null,8,["text"])])),_:1},8,["content"]),(0,n.Wm)(m,{class:"box-item",effect:"dark",content:e.imageTimeline.use.title,placement:"top"},{default:(0,n.w5)((()=>[(0,n.Wm)((0,i.SU)(s["default"]),{icon:"file-2-line",text:e.imageTimeline.use.value,class:"icon"},null,8,["text"])])),_:1},8,["content"])],64)):(0,n.kq)("",!0)])}}};function c(e){e.__source="src/components/Topic/image_actions.vue"}var u=a(83744);"function"===typeof c&&c(r);const d=(0,u.Z)(r,[["__scopeId","data-v-0116e455"]]);var m=d},64039:function(e,t,a){a.r(t),a.d(t,{default:function(){return p}});var o=a(69950),n=(a(3241),a(82123),a(19615),a(66252)),i=a(2262),s=a(3577),l=a(96486);const r={class:"timeline-container"},c={class:"actions"};var u=(0,n.aZ)({__name:"image_timeline",props:{detail:{type:Object,default:()=>{}}},setup(e){const t=e,a=(0,n.Fl)((()=>(0,l.omit)(t.detail,["author","homepage","download","size","use"])));return(e,t)=>{const l=o._T,u=o.rJ;return(0,n.wg)(),(0,n.iD)("div",r,[(0,n.Wm)(u,null,{default:(0,n.w5)((()=>[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)((0,i.SU)(a),((e,t)=>((0,n.wg)(),(0,n.j4)(l,{key:t,timestamp:e.value},{default:(0,n.w5)((()=>[(0,n.Uk)((0,s.zw)(e.title),1)])),_:2},1032,["timestamp"])))),128))])),_:1}),(0,n._)("div",c,[(0,n.WI)(e.$slots,"default")])])}}});function d(e){e.__source="src/components/Topic/image_timeline.vue"}var m=a(83744);"function"===typeof d&&d(u);const f=(0,m.Z)(u,[["__scopeId","data-v-0345c8cd"]]);var p=f},16299:function(e,t,a){a.r(t),a.d(t,{default:function(){return m}});var o=a(25917),n=(a(3241),a(27109),a(61684),a(57122)),i=(a(69540),a(66252)),s=a(2262);const l={class:"image-box"};var r={__name:"images",props:{images:{type:Array,default:()=>[]},imageIndex:{type:Number,default:0}},emits:["change"],setup(e,{emit:t}){const a=e,r=(0,i.Fl)((()=>a.images.length<=1?"never":"always")),c=(0,i.Fl)((()=>{const e=a.images.map((e=>e.height))||[];return Math.max(...e)}));function u(e){t("change",e)}return(t,a)=>{const d=n.F8,m=o.B6,f=o.$J;return(0,i.wg)(),(0,i.j4)(f,{height:(0,s.SU)(c)+"px",autoplay:!1,"initial-index":e.imageIndex,arrow:(0,s.SU)(r),"indicator-position":e.images.length>1?"":"none",onChange:u},{default:(0,i.w5)((()=>[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.images,(e=>((0,i.wg)(),(0,i.j4)(m,{key:e.id},{default:(0,i.w5)((()=>[(0,i._)("div",l,[(0,i.Wm)(d,{src:e.image},null,8,["src"])])])),_:2},1024)))),128))])),_:1},8,["height","initial-index","arrow","indicator-position"])}}};function c(e){e.__source="src/components/Topic/images.vue"}var u=a(83744);"function"===typeof c&&c(r);const d=(0,u.Z)(r,[["__scopeId","data-v-6c37c3bc"]]);var m=d},16693:function(e,t,a){a.r(t),a.d(t,{default:function(){return v}});var o=a(73481),n=(a(3241),a(62029),a(15659)),i=(a(10444),a(20129)),s=(a(69840),a(57018)),l=(a(74367),a(6589),a(47820)),r=(a(50986),a(61715),a(66252)),c=a(2262),u=a(53580),d=a(63877);const m={class:"dialog-footer"};var f={__name:"report",setup(e,{expose:t}){const a=(0,r.f3)("$baseMessage"),f=["垃圾广告","攻击骚扰","违法违规","色情低俗","不实信息","抄袭侵权","其它"],p={report_select:"",message:"",rid:0,fid:0},g=(0,c.qj)({queryForm:{...p},rules:{...d.jl},dialogVisible:!1,formRef:null}),{queryForm:v,rules:_,dialogVisible:w,formRef:y}=(0,c.BK)(g);function h(e,t){g.dialogVisible=!0,v.value.rid=e,v.value.fid=t}function b(){g["formRef"].validate((async e=>{if(e){const e=await(0,u.yo)(v.value);a(e.msg,"success","vab-hey-message-success"),g.queryForm={...p},g.dialogVisible=!1}}))}return t({showDialog:h}),(e,t)=>{const a=l.BT,u=l.km,d=i.nH,p=s.EZ,g=i.ly,h=n.ElButton,x=o.d0;return(0,r.wg)(),(0,r.j4)(x,{modelValue:(0,c.SU)(w),"onUpdate:modelValue":t[3]||(t[3]=e=>(0,c.dq)(w)?w.value=e:null),title:"举报帖子",width:"30%"},{footer:(0,r.w5)((()=>[(0,r._)("span",m,[(0,r.Wm)(h,{onClick:t[2]||(t[2]=e=>w.value=!1)},{default:(0,r.w5)((()=>[(0,r.Uk)("取消")])),_:1}),(0,r.Wm)(h,{type:"primary",onClick:b},{default:(0,r.w5)((()=>[(0,r.Uk)("确认")])),_:1})])])),default:(0,r.w5)((()=>[(0,r.Wm)(g,{ref_key:"formRef",ref:y,model:(0,c.SU)(v),rules:(0,c.SU)(_)},{default:(0,r.w5)((()=>[(0,r.Wm)(d,{prop:"report_select"},{default:(0,r.w5)((()=>[(0,r.Wm)(u,{modelValue:(0,c.SU)(v).report_select,"onUpdate:modelValue":t[0]||(t[0]=e=>(0,c.SU)(v).report_select=e),placeholder:"举报类型"},{default:(0,r.w5)((()=>[((0,r.wg)(),(0,r.iD)(r.HY,null,(0,r.Ko)(f,(e=>(0,r.Wm)(a,{key:e,label:e,value:e},null,8,["label","value"]))),64))])),_:1},8,["modelValue"])])),_:1}),(0,r.Wm)(d,{prop:"message"},{default:(0,r.w5)((()=>[(0,r.Wm)(p,{modelValue:(0,c.SU)(v).message,"onUpdate:modelValue":t[1]||(t[1]=e=>(0,c.SU)(v).message=e),rows:3,type:"textarea",placeholder:"举报内容"},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue"])}}};function p(e){e.__source="src/components/Topic/report.vue"}"function"===typeof p&&p(f);const g=f;var v=g},1479:function(e,t,a){a.r(t),a.d(t,{default:function(){return S}});var o=a(57534),n=(a(3241),a(92471),a(15659)),i=(a(10444),a(77669)),s=(a(95774),a(66252)),l=a(2262),r=a(3577),c=a(15904),u=a(15790);const d={key:0,class:"item"},m={class:"row"},f={class:"name"},p={class:"author"},g=["innerHTML"],v={key:0},_={class:"content"},w={class:"tags-box"};var y={__name:"topic",props:{topic:{type:Object,default:()=>{}},canAction:{type:Boolean,default:!1},tags:{type:Array,default:()=>[]}},setup(e){const t=e,a=(0,u.L)(),y=(0,s.Fl)((()=>t.topic)),h=(0,s.Fl)((()=>(0,c.x)(t.topic.detail))),b=(0,s.Fl)((()=>parseInt(y.value.extraInfo.follow_record)>0)),x=(0,s.Fl)((()=>y.value.detail.authorid));async function S(){await a.handleAddFollowUser(x.value),y.value.extraInfo.follow_record=1}async function k(){await a.handleDelFollowUser(x.value),y.value.extraInfo.follow_record=0}return(t,a)=>{const c=i.vs,u=(0,s.up)("router-link"),y=(0,s.up)("vab-icon"),x=n.ElButton,U=o.Ks;return(0,l.SU)(h)?((0,s.wg)(),(0,s.iD)("div",d,[(0,s._)("div",m,[(0,s.Wm)(u,{to:(0,l.SU)(h).author_route},{default:(0,s.w5)((()=>[(0,s.Wm)(c,{src:(0,l.SU)(h).avatar},null,8,["src"])])),_:1},8,["to"]),(0,s._)("div",f,[(0,s.Wm)(u,{to:(0,l.SU)(h).author_route},{default:(0,s.w5)((()=>[(0,s._)("div",p,(0,r.zw)((0,l.SU)(h).author),1)])),_:1},8,["to"]),(0,s._)("div",{innerHTML:(0,l.SU)(h).dateline},null,8,g)]),e.canAction?((0,s.wg)(),(0,s.iD)("div",v,[(0,l.SU)(b)?((0,s.wg)(),(0,s.j4)(x,{key:1,round:"",type:"warning",size:"small",onClick:k},{default:(0,s.w5)((()=>[(0,s.Wm)(y,{icon:"group-line"}),(0,s.Uk)(" 取消关注 ")])),_:1})):((0,s.wg)(),(0,s.j4)(x,{key:0,round:"",type:"primary",size:"small",onClick:S},{default:(0,s.w5)((()=>[(0,s.Wm)(y,{icon:"group-line"}),(0,s.Uk)(" 关注 ")])),_:1}))])):(0,s.kq)("",!0)]),(0,s._)("div",_,(0,r.zw)((0,l.SU)(h).subject),1),(0,s._)("div",w,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.tags,(e=>((0,s.wg)(),(0,s.j4)(u,{key:e.id,to:{path:"/index",query:{tag:e.name}}},{default:(0,s.w5)((()=>[(0,s.Wm)(U,{type:"info"},{default:(0,s.w5)((()=>[(0,s.Uk)((0,r.zw)(e.name),1)])),_:2},1024)])),_:2},1032,["to"])))),128))])])):(0,s.kq)("",!0)}}};function h(e){e.__source="src/components/Topic/topic.vue"}var b=a(83744);"function"===typeof h&&h(y);const x=(0,b.Z)(y,[["__scopeId","data-v-b6ea1fbc"]]);var S=x},27750:function(e,t,a){a.d(t,{Z:function(){return f}});var o=a(30032),n=(a(3241),a(91154),a(97830)),i=(a(13768),a(66252)),s=a(2262),l=a(3577),r=a(22201),c=(0,i.aZ)({__name:"index",props:{header:{type:String,default:""},bodyStyle:{type:Object,default:()=>({})},shadow:{type:String,default:""},skeleton:{type:Boolean,default:!1},skeletonRows:{type:Number,default:4}},setup(e){let t=null;const a=(0,s.iH)(!0);return t=setTimeout((()=>{a.value=!1}),500),(0,r.iS)(((e,a,o)=>{clearInterval(t),o()})),(t,r)=>{const c=n.vk,u=o.Kf;return(0,i.wg)(),(0,i.j4)(u,{"body-style":e.bodyStyle,class:"vab-card",shadow:e.shadow},(0,i.Nv)({default:(0,i.w5)((()=>[e.skeleton?((0,i.wg)(),(0,i.j4)(c,{key:0,animated:"",loading:(0,s.SU)(a),rows:e.skeletonRows},{default:(0,i.w5)((()=>[(0,i.WI)(t.$slots,"default",{class:"vab-card-transition"})])),_:3},8,["loading","rows"])):(0,i.WI)(t.$slots,"default",{key:1,class:"vab-card-transition"})])),_:2},[t.$slots.header||e.header?{name:"header",fn:(0,i.w5)((()=>[(0,i.WI)(t.$slots,"header",{},(()=>[(0,i.Uk)((0,l.zw)(e.header),1)]))])),key:"0"}:void 0]),1032,["body-style","shadow"])}}});function u(e){e.__source="library/components/VabCard/index.vue"}var d=a(83744);"function"===typeof u&&u(c);const m=(0,d.Z)(c,[["__scopeId","data-v-391150ea"]]);var f=m}}]);