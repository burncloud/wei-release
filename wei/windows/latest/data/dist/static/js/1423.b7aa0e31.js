/*!
 *  build: Vue  Admin Plus
 *  copyright: vue-admin-beautiful.com
 *  time: 2023-11-06 12:25:27
 */
"use strict";(self["webpackChunkadmin_plus"]=self["webpackChunkadmin_plus"]||[]).push([[1423,9884],{76841:function(t,e,n){n.d(e,{g8:function(){return r},gp:function(){return a},q1:function(){return l}});var o=n(13517);function a(t){return(0,o.Z)({url:"/table/getList",method:"get",params:t})}function r(t){return(0,o.Z)({url:"/table/doEdit",method:"post",data:t})}function l(t){return(0,o.Z)({url:"/table/doDelete",method:"post",data:t})}},26010:function(t,e,n){n.d(e,{Gc:function(){return r},TD:function(){return o},Vj:function(){return a},wV:function(){return l},xV:function(){return u}});n(57658);function o(t,e){if(0===arguments.length)return null;const n=e||"{y}-{m}-{d} {h}:{i}:{s}";let o;"object"===typeof t?o=t:("string"===typeof t&&/^[0-9]+$/.test(t)&&(t=parseInt(t)),"number"===typeof t&&10===t.toString().length&&(t*=1e3),o=new Date(t));const a={y:o.getFullYear(),m:o.getMonth()+1,d:o.getDate(),h:o.getHours(),i:o.getMinutes(),s:o.getSeconds(),a:o.getDay()};return n.replace(/{([ymdhisa])+}/g,((t,e)=>{let n=a[e];return"a"===e?["日","一","二","三","四","五","六"][n]:(t.length>0&&n<10&&(n=`0${n}`),n||0)}))}function a(t=32){const e="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890";let n="";for(let o=0;o<t;o++)n+=e.charAt(Math.floor(Math.random()*e.length));return n}function r(t,e,n){const o=Math.ceil(n/e);return t>=o}function l(t=0){document.getElementById("image-form-scroll").scrollTo({top:t,left:0,behavior:"smooth"})}function i(t=0){document.getElementById("task-queue-scroll").scrollTo({top:t,left:0,behavior:"smooth"})}function u(t=0){l(t),i(t)}},71423:function(t,e,n){n.r(e),n.d(e,{default:function(){return b}});var o=n(4350),a=(n(3241),n(91103),n(3837)),r=(n(81010),n(57534)),l=(n(92471),n(50363),n(7608)),i=n(49927),u=n(15659),s=(n(10444),n(66252)),d=n(3577);const c={class:"merge-header-container"};function f(t,e,n,f,m,g){const h=u.ElButton,w=i.Z,p=l.Z,_=a.$Y,b=r.Ks,v=a.eI,y=o.t;return(0,s.wg)(),(0,s.iD)("div",c,[(0,s.Wm)(p,null,{default:(0,s.w5)((()=>[(0,s.Wm)(w,{span:24},{default:(0,s.w5)((()=>[(0,s.Wm)(h,{loading:t.downloadLoading,type:"primary",onClick:t.handleDownload},{default:(0,s.w5)((()=>[(0,s.Uk)(" 导出 ")])),_:1},8,["loading","onClick"])])),_:1})])),_:1}),(0,s.wy)(((0,s.wg)(),(0,s.j4)(v,{ref:"multipleTable",border:"",data:t.list},{default:(0,s.w5)((()=>[(0,s.Wm)(_,{align:"center",label:"序号",width:"55"},{default:(0,s.w5)((({$index:t})=>[(0,s.Uk)((0,d.zw)(t+1),1)])),_:1}),(0,s.Wm)(_,{align:"center",label:"Main Information"},{default:(0,s.w5)((()=>[(0,s.Wm)(_,{label:"Title"},{default:(0,s.w5)((({row:t})=>[(0,s.Uk)((0,d.zw)(t.title),1)])),_:1}),(0,s.Wm)(_,{align:"center",label:"Author"},{default:(0,s.w5)((({row:t})=>[(0,s.Wm)(b,null,{default:(0,s.w5)((()=>[(0,s.Uk)((0,d.zw)(t.author),1)])),_:2},1024)])),_:1}),(0,s.Wm)(_,{align:"center",label:"Readings"},{default:(0,s.w5)((({row:t})=>[(0,s.Uk)((0,d.zw)(t.pageViews),1)])),_:1})])),_:1}),(0,s.Wm)(_,{align:"center",label:"Date"},{default:(0,s.w5)((({row:t})=>[(0,s._)("span",null,(0,d.zw)(t.datetime),1)])),_:1})])),_:1},8,["data"])),[[y,t.listLoading]])])}var m=n(76841),g=n(26010),h=(0,s.aZ)({name:"ExportMergeHeaderExcel",data(){return{list:[],listLoading:!0,downloadLoading:!1}},created(){this.fetchData()},methods:{async fetchData(){this.listLoading=!0;const{data:{list:t}}=await(0,m.gp)();this.list=t,this.listLoading=!1},handleDownload(){this.downloadLoading=!0,Promise.all([n.e(399),n.e(455)]).then(n.bind(n,455)).then((t=>{const e=[["Id","Main Information","","","Date"]],n=["","Title","Author","Readings",""],o=["id","title","author","pageViews","datetime"],a=this.list,r=this.formatJson(o,a),l=["A1:A2","B1:D1","E1:E2"];t.export_json_to_excel({multiHeader:e,header:n,merges:l,data:r}),this.downloadLoading=!1}))},formatJson(t,e){return e.map((e=>t.map((t=>"timestamp"===t?(0,g.TD)(e[t]):e[t]))))}}});function w(t){t.__source="src/views/other/excel/exportMergeHeaderExcel.vue"}var p=n(83744);"function"===typeof w&&w(h);const _=(0,p.Z)(h,[["render",f]]);var b=_},49927:function(t,e,n){n.d(e,{Z:function(){return c}});var o=n(22040),a=(n(3241),n(99426),n(66252));const r={class:"top-panel"};function l(t,e){const n=o.Dv;return(0,a.wg)(),(0,a.j4)(n,{span:24},{default:(0,a.w5)((()=>[(0,a._)("div",r,[(0,a.WI)(t.$slots,"default")])])),_:3})}function i(t){t.__source="library/components/VabQueryForm/components/VabQueryFormTopPanel.vue"}var u=n(83744);const s={};"function"===typeof i&&i(s);const d=(0,u.Z)(s,[["render",l]]);var c=d},7608:function(t,e,n){n.d(e,{Z:function(){return d}});var o=n(73632),a=(n(3241),n(74965),n(66252));function r(t,e){const n=o.dq;return(0,a.wg)(),(0,a.j4)(n,{class:"vab-query-form",gutter:0},{default:(0,a.w5)((()=>[(0,a.WI)(t.$slots,"default",{},void 0,!0)])),_:3})}function l(t){t.__source="library/components/VabQueryForm/index.vue"}var i=n(83744);const u={};"function"===typeof l&&l(u);const s=(0,i.Z)(u,[["render",r],["__scopeId","data-v-172989c8"]]);var d=s}}]);